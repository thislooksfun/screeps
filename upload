mkdir compilefrom

cd coffee
for f in $(find . -name '*.coffee'); do
  f1="${f/.\//}"
  cp $f "../compilefrom/${f1//\//.}"
done
cd ..

coffee -b -o dist -c compilefrom

if [ -n "${1+x}" ]; then
  echo "Branch! $1"
  grunt screeps --branch="$1"
else
  grunt screeps
fi

rm -r compilefrom
rm -r dist